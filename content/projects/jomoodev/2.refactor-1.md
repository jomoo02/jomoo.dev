---
title: jomoo.dev 리팩터링-1 
description: 블로그 사이트 리팩터링 하기 첫 번째
date: 2023/12/25
---

# jomoo.dev 리팩터링-1
<div class="flex justify-end text-sm">2023/12/25</div>

### intro
이전 단어장 프로젝트의 리팩터링을 마무리하고, 리팩터링에 재미가 붙어, jomoo.dev 프로젝트의 코드도 리팩터링하려 한다. 이전에 기능 구현만을 우선했기에 훑어만 봐도 리팩터링할게 많아 보인다.  
일단 pinia store의 코드부터 리팩터링하겠다.  

### 이전 pinia store 구조
<img width="209" alt="스크린샷 2023-12-25 오후 3 13 06" src="https://github.com/jomoo02/jomoo.dev/assets/86420174/019bd152-1600-4965-955d-cbe0f15b0e2d">

어떤 레이아웃을 띄울지 정하는 상태와, 모달 상태를 다루는 `mainState.js`와 작성한 포스트들의 상태를 관리하는 `postData.js` 두 개의 저장소가 있다. 저장소의 구조와 네이밍 등을 변경하려 한다.

### `mainState.js`

```js
import { defineStore } from 'pinia';

export const useMainStateStore = defineStore('mainState', {
  state: () => ({
    defaultLayoutIdx: 0,
    modalCheck: false,
  }),
});

```

리팩터링 전 `mainState` 저장소
우선 해당 프로젝트에 pinia store는 option store의 형태다. pinia를 몇 번 사용하다보니, option store 보다는 setup store 형태가 더 사용하기 편했다. vue의 composition api와 script setup 방식과 유사해 이질감이 적다.  
따라서 pinia store의 문법을 setup store로 변경하겠다.

또한, 현재 해당 스토어에서는 상태만을 저장하고, 해당 상태를 외부에서 다루게 한다.  
외부에서는 상태를 함수 호출을 통해 간접적으로 변경시키고, 내부에서 직접 상태를 변경하는게 상태에 대한 책임에 집중해 예측 가능성 및 유지 보수성도 향상된다고 생각한다. 따라서 상태를 조작를 스토어에서 하도록 변경하려한다.  

마지막으로, 레이아웃을 정하는 상태와 modal 상태는 서로 다른 기능이기 때문에 기능에 따라 스토어를 분리하는 게 적합하다고 생각한다. 레이아웃에 관련된 스토어 `layoutStore`와 modal과 관련된 스토어 `modalStore`로 분리하겠다.  

