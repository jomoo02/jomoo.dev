---
title: 메인 페이지 변경
description: jomoo.dev 블로그 메인 페이지 변경하기
date: 2024/01/19
category: projects
detail: jomoodev
---

# 블로그 메인 페이지 변경하기
::creation-date{:date="date"}
::

### intro
jomoo.dev의 리팩터링을 일단락했으니 이번에는 새로운 메인 페이지를 만들려고 한다.    
현재 programmers, algorithms, vocabularynote의 포스트들만 메인 화면에서 보여주고 있다. 
이보다는 최근 작성한 글 순서대로 보여주는 것이 좋을 거 같다.  

### 새로운 메인 페이지에서 보여줄 작성한 글
새로운 메인 페이지에서 보여줄 글들은 category, detail과 관계없이 최근 작성한 순서대로 보여주려 한다.  
하지만, 날짜순으로 글들을 보여주면 어떤 category, detail 글인지 한 눈에 알기 어렵다. 따라서 해당 정보를 태그 버튼 형식으로 정보를 알리려 한다.  

이전 jomoo.dev 리팩터링 - 4 글에서 컴포넌트들을 리팩터링했었다. 바로 다음 글에서 또 변경하려니 slot을 이용해 재사용성을 늘려주는게 맞았나 싶었다. 
하지만 새롭게 추가하려는 태그 버튼은 이전에 예상하지 못했던 부분이었기에, 기능에 대한 새로운 영역이 필요하면 추가하는게 맞는 거 같다.   

작성한 글의 category와 detail 태그 버튼은 어떤 category, detail의 글인지에 대한 정보와 클릭하면 해당 category 또는 해당 detail index 페이지로 이동하는 기능을 갖게 했다.  

현재 category의 index 페이지는 없다. categroy의 detail 항목들에 대한 설명과 클릭하면 클릭한 detail index 페이지로 이동하는 카드들을 담은 페이지도 만들겠다.

### .md 파일에 머릿말에 category, detail 키 추가
추가할 tag 버튼은 클릭하면 클릭한 category 또는 detail의 index 페이지로 이동해야한다. 원하는 경로를 얻는 방법은 여러가지 있지만, 작성한 글인 .md 파일 머릿말에 catgegory와 detail의 key:value를 추가하는 것이 가장 간단한 방식인거 같다. 

``` md
---
title: 글 제목
...
category: projects
detail: jomoodev
---
```

### PostCard.vue에 tags slot 추가
```vue
<script setup>
const props = defineProps({
  path: {
    type: String,
    required: true,
  },

  title: {
    type: String,
    required: true,
  },

  description: {
    type: String,
    required: true,
  },

  date: {
    type: String,
    required: true,
  },
});
</script>

<template>
  <div class="flex flex-col py-3">
    <div class="flex flex-1">
      <NuxtLink :to="props.path">
        <div class="text-2xl font-bold truncate pb-3">
          {{ props.title }}
        </div>
        <div class="text-zinc-500 text-base leading-5">
          {{ props.description }}
        </div>
      </NuxtLink>
    </div>
    <div class="font-semibold text-sm">
      <slot name="tags" />
    </div>
    <div class="flex text-sm text-zinc-400">
      {{ props.date }}
    </div>
  </div>
</template>

```

tags slot 추가와 몇 가지 변경한 후의 `PostCard.vue` 컴포넌트  
`<slot name="tags" />`를 통해 해당 영역의 사용을 자유롭게 선택해 메인 페이지에서는 해당 영역을 사용하고 category detail index 페이지에서는 사용하지 않게 했다.  

이전 `PostCard.vue`에서는 `prop.size`를 이용해 css class 값을 동적으로 결정했는데, css class를 통일시켰다. 작은 사이즈의 PostCard를 사용하지 않기 때문이다.

또 다른 변경점으로, `<NuxtLink>`의 사용이다. 이전에는 `div` 태그에 클릭 이벤트로 `navigateTo`를 호출해 라우팅했었다.  
이번에 semantic tag에 대해 살짝 알게 됐는데, `div` 태그의 click 이벤트는 특정 이벤트를 실행 시킬 때 사용하고, `a` 태그는 경로를 이동할 때 사용하는 것이 의미적으로 적합하다고 한다. 따라서 `a` 태그를 대체하는 nuxt의 `<NuxtLink>`로 변경했다.

### category index 페이지
기본 레이아웃에서 note, projects를 클릭하거나 메인 페이지에 태그 버튼을 클릭 시 이동할 페이지  

`composables/useCategory.js`
```js
const categoriesMap = {
  note: [
    {
      detail: '프로그래머스',
      description: '프로그래머스 코딩 테스트 연습',
      path: '/note/programmers',
      iconName: 'ProgrammersIcon',
    },
    {
      detail: '알고리즘',
      description: '학습한 알고리즘 정리',
      path: '/note/algorithms',
      iconName: 'mynaui:math-square',
    },
    {
      detail: '우테코',
      description: '우테코 프리코스',
      path: '/note/wootecos',
      iconName: 'devicon-plain:woocommerce',
    },
    {
      detail: '자바스크립트',
      description: '학습한 자바스크립트 정리',
      path: '/note/js',
      iconName: 'fa6-brands:square-js',
    },
  ],

  projects: [
    {
      detail: 'vocabulary',
      description: 'vue3로 만든 토이 프로젝트 단어장',
      path: '/projects/vocabularynote',
      iconName: 'healthicons:i-note-action-outline',
    },
    {
      detail: 'jomoo.dev',
      description: `nuxt3와 nuxt-content로 만든 블로그`,
      path: '/projects/jomoodev',
      iconName: 'material-symbols-light:logo-dev-rounded',
    },
  ],
};

export function useCategory() {
  const category = ref('');
  const categoryItems = ref([]);
  const route = useRoute();

  category.value = route.params.category;
  categoryItems.value = categoriesMap[category.value];

  return { category, categoryItems };
}

```

`pages/[category]/index.vue`
```vue
<script setup>
const { category, categoryItems } = useCategory();
</script>

<template>
  <NuxtLayout name="side-bar">
    <div class="flex flex-col gap-y-5 py-3">
      <h1 class="text-xl font-bold capitalize">{{ category }}</h1>
      <div class="grid sm:grid-cols-2 gap-x-2 gap-y-8 xl:grid-cols-3">
        <div
          v-for="{ detail, path, description, iconName } in categoryItems"
          :key="detail"
          class="sm:max-w-72 md:w-80 h-44 lg:min-w-80 xl:w-72 xl:min-w-72"
        >
          <CategoryCard
            :detail="detail"
            :path="path"
            :description="description"
            :icon-name="iconName"
          />
        </div>
      </div>
    </div>
  </NuxtLayout>
</template>

```

컴포저블 함수 `useCategory`로 현재 경로의 `category`와 `categoryItems`를 얻어, `CategoryCard` 컴포넌트에 전달하여 현재 경로의 category의 details 정보를 렌더링한다.  

`components/CategoryCard.vue`
```vue
<script setup>
defineProps({
  detail: {
    type: String,
    default: 'category detail',
  },

  description: {
    type: String,
    default: 'category detail에 대한 설명',
  },

  iconName: {
    type: String,
    default: 'ion:accessibility',
  },

  path: {
    type: String,
    default: '/',
  },
});
</script>

<template>
  <NuxtLink :to="path">
    <div
      class="ring-1 ring-slate-300 hover:ring-emerald-500 hover:ring-2 rounded-xl w-full h-full py-3 px-4"
    >
      <div class="w-full h-20 flex items-center">
        <Icon :name="iconName" size="55" />
      </div>
      <div class="flex flex-col">
        <h3 class="text-lg py-1 font-medium truncate text-slate-800">{{ detail }}</h3>
        <div
          class="text-[14px] leading-4 text-slate-700/80 text-ellipsis overflow-hidden capitalize"
        >
          {{ description }}
        </div>
      </div>
    </div>
  </NuxtLink>
</template>

```

Category index 페이지에서 사용하는 카드 컴포넌트  
Category의 `detail`, `description`, `iconName`, `path`를 prop 데이터로 받아 화면에 렌더링한다.  
클릭하는 경우 해당 detail index 페이지로 이동한다.  


### 새로운 메인 페이지 `pages/index.vue`
```vue
<script setup>
const mainDescriptions = [
  '안녕하세요! 이곳은 개발자의 성장 이야기와 코드의 흔적를 기록하는 곳입니다.',
  'Nuxt3와 Nuxt-content 모듈을 활용하여 만들어진 이 블로그는 지식의 나눔을 추구합니다.',
];

const subDescription = `주요 주제로 코딩 테스트, 알고리즘, 자바스크립트 학습 내용과 진행했던 토이 프로젝트 관련 내용을 다룹니다!`;

const { data: recentWritePosts } = await useAsyncData(
  'recentWritePosts',
  () => {
    return queryContent('/')
      .sort({ date: -1 })
      .limit(5)
      .only(['_path', 'title', 'description', 'date', 'category', 'detail'])
      .find();
  },
  {
    transform(recentWritePosts) {
      return recentWritePosts.map((post) => {
        const tags = [
          { text: post.category, path: post.category },
          { text: post.detail, path: `${post.category}/${post.detail}` },
        ];
        return { ...post, tags };
      });
    },
  },
);

useHead({
  title: 'jomoo.dev',
  meta: [
    {
      name: 'description',
      content: subDescription,
    },
  ],
});
</script>

<template>
  <div class="flex flex-col gap-y-20">
    <section class="h-[calc(100vh-430px)] flex justify-center items-center flex-col gap-y-1">
      <h1 class="text-xl font-semibold text-center text-slate-700 truncate">
        <div v-for="mainDescription in mainDescriptions" :key="mainDescription">
          {{ mainDescription }}
        </div>
      </h1>

      <div class="text-base text-gray-500 font-medium">
        {{ subDescription }}
      </div>
    </section>
    <section class="lg:mx-24">
      <div class="flex flex-col gap-y-3 md:gap-y-4 py-4">
        <h2 class="text-2xl md:text-3xl text-zinc-700 font-extrabold">최신 글</h2>
        <div class="flex flex-col gap-y-2">
          <PostCard
            v-for="{ _path, title, description, date, tags } in recentWritePosts"
            :key="title"
            :date="date"
            :title="title"
            :path="_path"
            :description="description"
            class="min-h-[174px] max-h-[174px]"
          >
            <template #tags>
              <div class="flex gap-x-2 relative bottom-3">
                <NuxtLink v-for="{ path, text } in tags" :key="text" :to="path">
                  <div
                    class="flex bg-slate-200/60 rounded-xl px-[9px] py-[3px] hover:bg-gray-100 text-emerald-600/90 hover:text-emerald-700/90"
                  >
                    {{ text }}
                  </div>
                </NuxtLink>
              </div>
            </template>
          </PostCard>
        </div>
      </div>
    </section>
  </div>
</template>

```

이것저것 바꾼 새로운 메인 페이지  
`useAsyncData`의 `queryContent`에서 `sort({ date: -1 })`, `limit(5)`을 추가해 가장 최근에 작성한 글 5개를 순서대로 보여주며, `transform`에서 태그 버튼에 전달할 값들을 `tags` 필드로 추가했다.  
또한, 메인 페이지의 맨 위에 블로그에 대한 간단한 소개 문을 추가했다. 간단해도 적당한 말이 생각나지 않아 참 어려웠다...  

위에서 `PostCard.vue`에서 추가한 `<slot>`에 `<template #tags>`로 태그 버튼들을 넣었다.

### 구조 다이어그램
![strucure](/projects/jomoodev/new-mainpage/structure.png)

이번에 다뤘던 파일들에 대한 구조 다이어그램  
기본 레이아웃 `default.vue`를 상단으로 시작해 페이지 `category/index.vue`, 메인 페이지 `index.vue(main)`이 있다.  

`category/index.vue` 페이지는 컴포저블 함수 `useCategory.js`를 이용해 현재 경로에 따른 category 정보를 얻어 페이지에서 현재 category를 알리며, `CategoryCard.vue` 컴포넌트에 정보를 전달해 렌더링한다.

`index.vue(main)`은 작성한 글들을 `PostCard.vue`를 이용해 렌더링한다.  



---